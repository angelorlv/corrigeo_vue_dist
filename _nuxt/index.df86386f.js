import T from"./progressbar.esm.dd895d12.js";import E from"./button.esm.d3b6cf32.js";import{r as l,L as N,o as z,v,x as s,M as L,N as o,O as A,B as M,P as h,y,z as q,Q as Z,t as u}from"./entry.b91bfc8c.js";import"./basecomponent.esm.125dea15.js";import"./badge.esm.eb019133.js";import"./index.esm.cc0eafa1.js";import"./baseicon.esm.bed1fc89.js";const G="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAKkAAAA4CAMAAACxMSj7AAAARVBMVEVMaXEtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS3/as7/as7/as7/as7/as7/as4tLS3/as61rQLEAAAAFXRSTlMAZojMmUTddxHuqrsiM1VAwNBgUHDfpf63AAAACXBIWXMAAAsSAAALEgHS3X78AAAEgElEQVRoge1Z247cIAxNQsBAEna7Lf3/T6242oZkurNiqlTa8zDKBczBdybTN77x/wEC9nG0pfJioLgCUD4DdPfyS9DGe7+N5umMJ4Du/Vcgo8BB2y5YPMcQTbgXMF2jzMUFRUC8tt2Y56HVcOtHcrZu3obbuRv1PA7lt6ERtQdmK2euBrvXGGydtdfr5LLDmHD7Cg7vvfmsCoNHi+6pg1GZ7SHWZ9KSCJ5yNA+3YYntMcwzqWQ5izZ1qujhODov5YCYCkCmhzFH2sBXyDpsTXlzjkNXdPHDeMUc3oWJCnTYGzFCLI/cf+JIvzKdwEPTyVpjc74htczVQaxqILnZe4/7mfatzqTJ5shLGHSqQ5SRgnjaQtdsMVMGcZLFBxiGm6eoHDjTXZ2O2k0nj+0cBYSlr3KS48rSyVe8NwCGbvAoeoeFFlDGNFasMHPlTLf0VKFpD5NkJb/D+N2umcZmSMxo8EQEyr6XOtJ4L5KjAdkBY0picSVMXa64YSMqPRLV6nu4VJRpxxGFi2mSrM8q/FggqnrjSG6gTHfq2YBMbbE6FGPMHkukFkTcdp2kTFa3pq1Woado96HqypIEKGUKrGLjjSlXlelGLSFJAry2viO8Zkg91lZ9kzE1f2Uq2DKVqa4627w35QlJzgIVufJUQgA8yQuufMYUnYIyBRTdrF+Z7mUNKCJ4AEQPlCjuPJ8ufA8rVz5leqCMC6Y7X79jGoaaKH3m+iG37rJGNdQa5VOmDqOFMrU4Q3J9MOtDztKupdbc6stWauHNyAOdrugYlJK6YqpZRNlUkuaOWnt72QkBr17btZ8adEJC6SAlxjHrHyxL8Vo0X/ppfNUqFZYsD+dowxsmwpQKJ0yBENhYRJGUBU19T9UGl2Fx3B/MZu+FjqrCLTR7pUwV8Yu9Mo1rZss1B2pVmebTO9p048VeMm6xulOqpfAtJNh20+RdkfNfGlan6zrHYkVLNb9mfig32rKyN0069zrirEYVZqo8cKKUoqiVtKxUzakwRtFcZ+MeTE43mUS41qWJW5BoEIZ/h2TJqcWIjXkUGOs+69HzTizUTmdDbfsFQHjfnlddfqW49eIOTKpoJv6ma7XkVgoKuaxQm4kD5Jotj0Km6aVQqwQ0dxeY5vhE2k2q7B0fSxxjDtbZBupRf8Y1ixt52Z8mSEFeWuSEBur+YzjqK36uKt23kjgmduGVkai7sXri/foaH5z3/HVh2LKtecbi5yiKPZm1O0DLMEMks8QxoiTY2H+vrlAzNVuntS2KOjtH/XuUALenlfFGKCe8y8PbXVDOZuvdic4l9u/O1NXYvznTmNQtPUfdFaUmv5Tp24/ff8ePn908Cih1+pVMf32CZ8BHNxOhS/fySqZvHaUrvHVzK+baUbyQ6fsFrx7v3dwKW7vpFzLtCF2jm1uharPZnB9ux9Q0Z+dbM00niKNrFcdhiJ+K8hfj0rXy4zAk9stXmvhdqXs7Ch8dpXM8yqcytcv4d/GLtPqpGvVAo+wjwT2/dhKUTxfp68at4YJa1ZOmn6bpD6VuqJrtKlt7AAAAAElFTkSuQmCC",H={class:"flex flex-col w-screen h-screen"},J=s("div",{class:"fixed bg-white w-screen flex justify-center items-center"},[s("img",{src:G,height:"20",alt:"",srcset:""})],-1),Q={class:"h-full flex justify-center items-center"},Y=s("span",{class:"font-bold text-blue-500"},"Glisser",-1),X=s("span",{class:"font-bold text-green-500"}," Cliquer ",-1),O={key:1,class:"flex flex-col border border-green-500 w-[400px]"},R={class:"flex p-2 w-full border-b"},P={class:""},I=s("span",{class:"flex-grow"},null,-1),W={class:""},$={class:"flex p-2 border-b flex-col"},ee={key:0,class:"mr-2 flex-grow w-full"},te={class:"flex w-full justify-center p-2 border-b"},oe={key:1,class:"text-center w-full p-2"},se={class:"text-2xl underline-text-purple"},re={class:"fixed bottom-0 left-0 w-screen flex items-center justify-center p-2 font-bold text-sm"},pe={__name:"index",setup(le){const d=l("https://corrigeo-o86b.onrender.com"),b=N(),c=l(!0),g=l(!1),f=l(null),S=l(!1);l(!1),l(0);const r=l(-1),p=l(0),i=l(!1),w=l(""),m=l(0),x=l(!1),V=l(null);function C(e){const t=e.dataTransfer.files;if(t.length>0){const a=t[0];f.value=a,console.log(a),k()}}function U(e){console.log(e.target.files[0]),f.value=e.target.files[0],e.target.files.length>0&&k()}function j(){c.value&&document.querySelector("#inputDoc").click()}async function k(){try{const e=new FormData;e.append("file",f.value);const t=await fetch(`${d.value}/upload`,{method:"post",body:e,credentials:"include"});if(t.status!=200)b.add({severity:"error",detail:(await t.json()).message,life:4e3,summary:"Document non valide"});else{S.value=!0,c.value=!1;const a=await t.json();p.value=a.partitions}}catch(e){console.error(e)}}async function F(){try{const e=await fetch(`${d.value}/session`,{method:"get",credentials:"include"});e.status==200?(V.value=(await e.json()).user,console.log(V.value)):b.add({severity:"error",detail:"Erreur pendant la récupération des données utilisateur",life:4e3,summary:"Données Utilisateur"})}catch(e){console.error(e)}}async function D(){try{if(r.value+=1,r.value>=p.value)m.value=100,_();else{m.value=r.value*100/p.value,console.log(p.value);let e={state:r.value};const t=new URLSearchParams(e).toString();(await fetch(`${d.value}/correction?${t}`,{method:"get",credentials:"include"})).status==200?D():r.value<p.value?(b.add({detail:"Veuillez refaire la correction ou importez un autre document. Vous pouvez aussi contacter les développeurs",summary:"Erreur pendant la correction.",severity:"error",life:3e3}),r.value=-1):_()}}catch(e){console.error(e)}}async function _(){try{const e=await fetch(`${d.value}/finish-correction`,{method:"get",credentials:"include"});if(e.status==200){i.value=!0,r.value=-1;const t=await e.json();w.value=t.filename,x.value=!1}else x.value=!0}catch(e){console.error(e)}}async function K(){const e=new URLSearchParams({filename:w.value}).toString();fetch(`${d.value}/download?${e}`,{method:"get",credentials:"include"}).then(t=>t.blob()).then(t=>{const a=window.URL.createObjectURL(new Blob([t])),n=document.createElement("a");n.href=a,n.setAttribute("download",w.value),document.body.appendChild(n),n.click(),n.parentNode.removeChild(n)}).catch(t=>{console.error("Erreur lors du téléchargement du fichier :",t)})}return z(()=>{F()}),(e,t)=>{const a=T,n=E;return u(),v("div",H,[J,s("div",Q,[s("div",{class:L([{"border-dashed cursor-pointer hover:bg-gray-50":o(c),"border-blue-500":o(g)&&o(c)},"w-[80%] h-[80%] border-2 rounded-3xl flex justify-center items-center"]),onDragover:t[2]||(t[2]=A(B=>g.value=!0,["prevent"])),onDragleave:t[3]||(t[3]=A(B=>g.value=!1,["prevent"])),onDrop:A(C,["prevent"]),onClick:j},[s("input",{type:"file",class:"hidden",id:"inputDoc",onChange:U},null,32),o(c)?(u(),v("span",{key:0,class:L(["text-gray-400 text-2xl text-center",{"text-blue-500":o(g)&&o(c)}])},[Y,M(" ou "),X,M(" ici pour importer votre document word valide (.docx) ")],2)):h("",!0),!o(c)&&o(S)?(u(),v("div",O,[s("div",R,[s("span",P,y(o(f).name),1),I,s("span",W,y((parseInt(o(f).size)/1e3).toFixed(1))+" Ko",1)]),s("div",$,[o(r)!=-1?(u(),v("div",ee,[q(a,{value:o(m)},null,8,["value"])])):h("",!0),q(n,{label:o(i)?"Telecharger":"Corriger",onClick:t[0]||(t[0]=()=>{o(i)?K():!o(i)&&o(x)?(r.value=-1,_()):o(i)||D()}),loading:o(r)!=-1,class:L([{"flex-grow":o(r)==-1},"p-button-sm flex-grow"])},null,8,["label","loading","class"])]),s("div",te,[o(r)==-1?(u(),Z(n,{key:0,onClick:t[1]||(t[1]=A(()=>{c.value=!0,S.value=!1,r.value=-1,i.value=!1,x.value=!1,m.value=0},["stop"])),label:"Importer un autre document",class:"p-button-sm p-button-danger",text:""})):h("",!0),o(r)!=-1?(u(),v("div",oe,[s("span",se,y(o(m))+" % ",1)])):h("",!0)])])):h("",!0)],34)]),s("div",re,[s("span",null,"Tous droits réservés - Evolutech "+y(new Date().getFullYear()),1)])])}}};export{pe as default};
