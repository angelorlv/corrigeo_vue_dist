import z from"./progressspinner.esm.ff426793.js";import Z from"./progressbar.esm.d4c358d7.js";import G from"./button.esm.76cff04e.js";import{r,L as H,o as J,v as d,x as s,M as L,N as o,O as y,B as C,P as U,Q as h,y as A,z as j,t as i}from"./entry.99263a14.js";import"./basecomponent.esm.476ddb1b.js";import"./badge.esm.1ffa918f.js";import"./index.esm.af66e982.js";import"./baseicon.esm.f0a5ae8d.js";const Q="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAKkAAAA4CAMAAACxMSj7AAAARVBMVEVMaXEtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS3/as7/as7/as7/as7/as7/as4tLS3/as61rQLEAAAAFXRSTlMAZojMmUTddxHuqrsiM1VAwNBgUHDfpf63AAAACXBIWXMAAAsSAAALEgHS3X78AAAEgElEQVRoge1Z247cIAxNQsBAEna7Lf3/T6242oZkurNiqlTa8zDKBczBdybTN77x/wEC9nG0pfJioLgCUD4DdPfyS9DGe7+N5umMJ4Du/Vcgo8BB2y5YPMcQTbgXMF2jzMUFRUC8tt2Y56HVcOtHcrZu3obbuRv1PA7lt6ERtQdmK2euBrvXGGydtdfr5LLDmHD7Cg7vvfmsCoNHi+6pg1GZ7SHWZ9KSCJ5yNA+3YYntMcwzqWQ5izZ1qujhODov5YCYCkCmhzFH2sBXyDpsTXlzjkNXdPHDeMUc3oWJCnTYGzFCLI/cf+JIvzKdwEPTyVpjc74htczVQaxqILnZe4/7mfatzqTJ5shLGHSqQ5SRgnjaQtdsMVMGcZLFBxiGm6eoHDjTXZ2O2k0nj+0cBYSlr3KS48rSyVe8NwCGbvAoeoeFFlDGNFasMHPlTLf0VKFpD5NkJb/D+N2umcZmSMxo8EQEyr6XOtJ4L5KjAdkBY0picSVMXa64YSMqPRLV6nu4VJRpxxGFi2mSrM8q/FggqnrjSG6gTHfq2YBMbbE6FGPMHkukFkTcdp2kTFa3pq1Woado96HqypIEKGUKrGLjjSlXlelGLSFJAry2viO8Zkg91lZ9kzE1f2Uq2DKVqa4627w35QlJzgIVufJUQgA8yQuufMYUnYIyBRTdrF+Z7mUNKCJ4AEQPlCjuPJ8ufA8rVz5leqCMC6Y7X79jGoaaKH3m+iG37rJGNdQa5VOmDqOFMrU4Q3J9MOtDztKupdbc6stWauHNyAOdrugYlJK6YqpZRNlUkuaOWnt72QkBr17btZ8adEJC6SAlxjHrHyxL8Vo0X/ppfNUqFZYsD+dowxsmwpQKJ0yBENhYRJGUBU19T9UGl2Fx3B/MZu+FjqrCLTR7pUwV8Yu9Mo1rZss1B2pVmebTO9p048VeMm6xulOqpfAtJNh20+RdkfNfGlan6zrHYkVLNb9mfig32rKyN0069zrirEYVZqo8cKKUoqiVtKxUzakwRtFcZ+MeTE43mUS41qWJW5BoEIZ/h2TJqcWIjXkUGOs+69HzTizUTmdDbfsFQHjfnlddfqW49eIOTKpoJv6ma7XkVgoKuaxQm4kD5Jotj0Km6aVQqwQ0dxeY5vhE2k2q7B0fSxxjDtbZBupRf8Y1ixt52Z8mSEFeWuSEBur+YzjqK36uKt23kjgmduGVkai7sXri/foaH5z3/HVh2LKtecbi5yiKPZm1O0DLMEMks8QxoiTY2H+vrlAzNVuntS2KOjtH/XuUALenlfFGKCe8y8PbXVDOZuvdic4l9u/O1NXYvznTmNQtPUfdFaUmv5Tp24/ff8ePn908Cih1+pVMf32CZ8BHNxOhS/fySqZvHaUrvHVzK+baUbyQ6fsFrx7v3dwKW7vpFzLtCF2jm1uharPZnB9ux9Q0Z+dbM00niKNrFcdhiJ+K8hfj0rXy4zAk9stXmvhdqXs7Ch8dpXM8yqcytcv4d/GLtPqpGvVAo+wjwT2/dhKUTxfp68at4YJa1ZOmn6bpD6VuqJrtKlt7AAAAAElFTkSuQmCC",Y={class:"flex flex-col w-screen h-screen"},X=s("div",{class:"fixed bg-white w-screen flex justify-center items-center"},[s("img",{src:Q,height:"20",alt:"",srcset:""})],-1),O={class:"h-full flex justify-center items-center"},P={key:0},R=s("span",{class:"font-bold text-blue-500"},"Glisser",-1),I=s("span",{class:"font-bold text-green-500"}," Cliquer ",-1),W={key:1,class:"flex flex-col border border-green-500 w-[400px]"},$={class:"flex p-2 w-full border-b"},ee={class:""},te=s("span",{class:"flex-grow"},null,-1),oe={class:""},se={class:"flex p-2 border-b flex-col"},re={key:0,class:"mr-2 flex-grow w-full"},le={class:"flex w-full justify-center p-2 border-b"},ne={key:1,class:"text-center w-full p-2"},ae={class:"text-2xl underline-text-purple"},ce={class:"fixed bottom-0 left-0 w-screen flex items-center justify-center p-2 font-bold text-sm"},xe={__name:"index",setup(ie){const f=r("https://corrigeo-o86b.onrender.com"),b=H(),a=r(!0),g=r(!1),p=r(null),S=r(!1);r(!1),r(0);const l=r(-1),m=r(0),u=r(!1),_=r(""),v=r(0),x=r(!1),V=r(null),w=r(!1);function F(e){const t=e.dataTransfer.files;if(t.length>0){const n=t[0];p.value=n,console.log(n),D()}}function K(e){console.log(e.target.files[0]),p.value=e.target.files[0],e.target.files.length>0&&D()}function B(){a.value&&document.querySelector("#inputDoc").click()}async function D(){w.value=!0;try{const e=new FormData;e.append("file",p.value);const t=await fetch(`${f.value}/upload`,{method:"post",body:e,credentials:"include"});if(t.status!=200)b.add({severity:"error",detail:(await t.json()).message,life:4e3,summary:"Document non valide"});else{S.value=!0,a.value=!1;const n=await t.json();m.value=n.partitions}}catch(e){console.error(e)}w.value=!1}async function T(){try{const e=await fetch(`${f.value}/session`,{method:"get",credentials:"include"});e.status==200?(V.value=(await e.json()).user,console.log(V.value)):b.add({severity:"error",detail:"Erreur pendant la récupération des données utilisateur",life:4e3,summary:"Données Utilisateur"})}catch(e){console.error(e)}}async function M(){try{if(l.value+=1,l.value>=m.value)v.value=100,k();else{v.value=l.value*100/m.value,console.log(m.value);let e={state:l.value};const t=new URLSearchParams(e).toString();(await fetch(`${f.value}/correction?${t}`,{method:"get",credentials:"include"})).status==200?M():l.value<m.value?(b.add({detail:"Veuillez refaire la correction ou importez un autre document. Vous pouvez aussi contacter les développeurs",summary:"Erreur pendant la correction.",severity:"error",life:3e3}),l.value=-1):k()}}catch(e){console.error(e)}}async function k(){try{const e=await fetch(`${f.value}/finish-correction`,{method:"get",credentials:"include"});if(e.status==200){u.value=!0,l.value=-1;const t=await e.json();_.value=t.filename,x.value=!1}else x.value=!0}catch(e){console.error(e)}}async function E(){const e=new URLSearchParams({filename:_.value}).toString();fetch(`${f.value}/download?${e}`,{method:"get",credentials:"include"}).then(t=>t.blob()).then(t=>{const n=window.URL.createObjectURL(new Blob([t])),c=document.createElement("a");c.href=n,c.setAttribute("download",_.value),document.body.appendChild(c),c.click(),c.parentNode.removeChild(c)}).catch(t=>{console.error("Erreur lors du téléchargement du fichier :",t)})}return J(()=>{T()}),(e,t)=>{const n=z,c=Z,q=G;return i(),d("div",Y,[X,s("div",O,[s("div",{class:L([{"border-dashed cursor-pointer hover:bg-gray-50":o(a),"border-blue-500":o(g)&&o(a)},"w-[80%] h-[80%] border-2 rounded-3xl flex justify-center items-center"]),onDragover:t[2]||(t[2]=y(N=>g.value=!0,["prevent"])),onDragleave:t[3]||(t[3]=y(N=>g.value=!1,["prevent"])),onDrop:y(F,["prevent"]),onClick:B},[s("input",{type:"file",class:"hidden",id:"inputDoc",onChange:K},null,32),o(a)?(i(),d("div",{key:0,class:L(["text-gray-400 text-2xl text-center",{"text-blue-500":o(g)&&o(a)}])},[o(w)?(i(),U(n,{key:1})):(i(),d("span",P,[R,C(" ou "),I,C(" ici pour importer votre document word valide (.docx) ")]))],2)):h("",!0),!o(a)&&o(S)?(i(),d("div",W,[s("div",$,[s("span",ee,A(o(p).name),1),te,s("span",oe,A((parseInt(o(p).size)/1e3).toFixed(1))+" Ko",1)]),s("div",se,[o(l)!=-1?(i(),d("div",re,[j(c,{value:o(v)},null,8,["value"])])):h("",!0),j(q,{label:o(u)?"Telecharger":"Corriger",onClick:t[0]||(t[0]=()=>{o(u)?E():!o(u)&&o(x)?(l.value=-1,k()):o(u)||M()}),loading:o(l)!=-1,class:L([{"flex-grow":o(l)==-1},"p-button-sm flex-grow"])},null,8,["label","loading","class"])]),s("div",le,[o(l)==-1?(i(),U(q,{key:0,onClick:t[1]||(t[1]=y(()=>{a.value=!0,S.value=!1,l.value=-1,u.value=!1,x.value=!1,v.value=0},["stop"])),label:"Importer un autre document",class:"p-button-sm p-button-info",text:""})):h("",!0),o(l)!=-1?(i(),d("div",ne,[s("span",ae,A(o(v))+" % ",1)])):h("",!0)])])):h("",!0)],34)]),s("div",ce,[s("span",null,"Tous droits réservés - Evolutech "+A(new Date().getFullYear()),1)])])}}};export{xe as default};
